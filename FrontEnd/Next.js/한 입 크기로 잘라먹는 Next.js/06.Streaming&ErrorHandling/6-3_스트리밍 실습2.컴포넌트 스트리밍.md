# `<Suspense />`

- 컴포넌트 단위로 스트리밍을 적용할 수 있다.

## 비동기 함수에 `Suspense` 사용하기

1. 페이지 함수에 `<Suspense>` 컴포넌트로 비동기 함수를 걈싸준다.
2. `fallback` 속성으로 로딩 중 보여줄 UI를 설정한다.
3. `key` 속성으로 값이 변할 때만다 다시 로딩 상태로 돌아갈 수 있도록 설정한다.

   ### `Suspense`는 경로가 변경될 때 fallback이 동작한다.

   - 이전에 페이지 스트리밍을 동작했을 때와 마찬가지로 경로가 변하는 것이 아닌 쿼리스트링 값이 변하는 것에는 로딩 페이지가 동작을 하지 않는다. loading.tsx 파일 방식으로는 이 방법을 해결할 수 없었었다.
   - `Suspense` 방식에서는 `key` 값을 활용하여 문제를 해결할 수 있다.
   - `key` 속성에 쿼리스트링의 값을 넣어주면 해당 값이 변할 때마다 로딩을 표시해 줄 수 있게된다.
   - 원래 `Suspense`컴포넌트는 최초 한 번 내부 컴포넌트의 로딩이 완료되면 내부의 어떤 콘텐츠가 변경되어도 새롭게 다시 로딩해주지 않는다.
   - 다만, `key` 값을 넣어주면 해당 값이 바뀔 떄마다 해당 컴포넌트 자체를 아예 새롭게 화면에 다시 그리도록 설정하게 된다.
